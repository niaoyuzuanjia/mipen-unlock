<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>小米巨能写BL解锁工具</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
<style>
        :root {
            /* MD3 浅色主题颜色系统 */
            --primary: #6750A4;
            --on-primary: #FFFFFF;
            --primary-container: #EADDFF;
            --on-primary-container: #21005D;
            --secondary: #625B71;
            --on-secondary: #FFFFFF;
            --secondary-container: #E8DEF8;
            --on-secondary-container: #1D192B;
            --tertiary: #7D5260;
            --on-tertiary: #FFFFFF;
            --tertiary-container: #FFD8E4;
            --on-tertiary-container: #31111D;
            --error: #B3261E;
            --on-error: #FFFFFF;
            --error-container: #F9DEDC;
            --on-error-container: #410E0B;
            --background: #FFFBFE;
            --on-background: #1C1B1F;
            --surface: #FFFBFE;
            --on-surface: #1C1B1F;
            --surface-variant: #E7E0EC;
            --on-surface-variant: #49454F;
            --outline: #79747E;
            --shadow: #000000;
            

            
            /* 形状系统 */
            --shape-corner-extra-small: 4px;
            --shape-corner-small: 8px;
            --shape-corner-medium: 12px;
            --shape-corner-large: 16px;
            --shape-corner-extra-large: 28px;
            --shape-corner-full: 9999px;
            
            /* 高程阴影 */
            --elevation-1: 0px 1px 2px rgba(0, 0, 0, 0.3), 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
            --elevation-2: 0px 1px 2px rgba(0, 0, 0, 0.3), 0px 2px 6px 2px rgba(0, 0, 0, 0.15);
            --elevation-3: 0px 4px 8px 3px rgba(0, 0, 0, 0.15), 0px 1px 3px rgba(0, 0, 0, 0.3);
            
            /* 动画曲线 */
            --motion-easing-emphasized: cubic-bezier(0.2, 0, 0, 1);
            --motion-duration-short4: 200ms;
            
            /* 主题切换动画 */
            --theme-transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* 深色主题变量 */
        .dark-mode {
            --primary: #D0BCFF;
            --on-primary: #371E73;
            --primary-container: #4F378B;
            --on-primary-container: #EADDFF;
            --secondary: #CCC2DC;
            --on-secondary: #332D41;
            --secondary-container: #4A4458;
            --on-secondary-container: #E8DEF8;
            --tertiary: #EFB8C8;
            --on-tertiary: #492532;
            --tertiary-container: #633B48;
            --on-tertiary-container: #FFD8E4;
            --error: #F2B8B5;
            --on-error: #601410;
            --error-container: #8C1D18;
            --on-error-container: #F9DEDC;
            --background: #1C1B1F;
            --on-background: #E6E1E5;
            --surface: #1C1B1F;
            --on-surface: #E6E1E5;
            --surface-variant: #49454F;
            --on-surface-variant: #CAC4D0;
            --outline: #938F99;
            --shadow: #000000;
            
            /* 深色模式阴影调整 */
            --elevation-1: 0px 1px 2px rgba(0, 0, 0, 0.5), 0px 1px 3px 1px rgba(0, 0, 0, 0.3);
            --elevation-2: 0px 1px 2px rgba(0, 0, 0, 0.5), 0px 2px 6px 2px rgba(0, 0, 0, 0.3);
            --elevation-3: 0px 4px 8px 3px rgba(0, 0, 0, 0.3), 0px 1px 3px rgba(0, 0, 0, 0.5);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Roboto', sans-serif;
        }

        body {
            background-color: var(--background);
            color: var(--on-background);
            line-height: 1.5;
            padding: 16px;
            background-image: var(--bg-image);
            background-size: cover;
            background-attachment: fixed;
            background-position: center;
            min-height: 100vh;
            transition: var(--theme-transition);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
        }

        /* 主题切换按钮 */
        .theme-toggle-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }

        .theme-toggle-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 50px;
            height: 50px;
            border-radius: var(--shape-corner-full);
            background-color: var(--primary-container);
            color: var(--on-primary-container);
            border: none;
            cursor: pointer;
            box-shadow: var(--elevation-2);
            transition: var(--theme-transition);
            overflow: hidden;
            position: relative;
        }

        .theme-toggle-btn:hover {
            transform: scale(1.1);
            box-shadow: var(--elevation-3);
        }

        .theme-toggle-btn:active {
            transform: scale(0.95);
        }

        .theme-icon {
            font-size: 24px;
            transition: transform 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55);
        }

        .dark-mode .theme-icon {
            transform: rotate(180deg);
        }

        .theme-toggle-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at center, rgba(255,255,255,0.1) 0%, transparent 70%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .theme-toggle-btn:hover::before {
            opacity: 1;
        }

        h1, h2, h3, h4 {
            margin-bottom: 16px;
            font-weight: 400;
            transition: var(--theme-transition);
        }

        h1 {
            font-size: 2rem;
            font-weight: 700;
            letter-spacing: -0.25px;
        }

        h2 {
            font-size: 1.5rem;
            font-weight: 500;
        }

        h3 {
            font-size: 1.25rem;
            font-weight: 500;
            color: var(--on-surface-variant);
        }

        .section {
            margin-bottom: 40px;
            padding: 24px;
            background: var(--surface);
            border-radius: var(--shape-corner-large);
            box-shadow: var(--elevation-1);
            transition: var(--theme-transition);
        }

        /* 按钮样式 - MD3 */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 10px 24px;
            margin: 4px;
            font-size: 14px;
            font-weight: 500;
            letter-spacing: 0.1px;
            text-transform: none;
            border: none;
            border-radius: 100px;
            cursor: pointer;
            outline: none;
            transition: all var(--motion-duration-short4) var(--motion-easing-emphasized);
            position: relative;
            overflow: hidden;
        }

        .btn::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            background: currentColor;
            opacity: 0;
            border-radius: inherit;
            transition: opacity 0.2s;
        }

        .btn:hover::after {
            opacity: 0.08;
        }

        .btn:focus::after {
            opacity: 0.12;
        }

        .btn:active::after {
            opacity: 0.12;
        }

        .btn-filled {
            background-color: var(--primary);
            color: var(--on-primary);
            box-shadow: var(--elevation-1);
        }

        .btn-filled:hover {
            box-shadow: var(--elevation-2);
        }

        .btn-outlined {
            background-color: transparent;
            color: var(--primary);
            border: 1px solid var(--outline);
        }

        .btn-outlined:hover {
            border-color: var(--primary);
            background-color: rgba(103, 80, 164, 0.08);
        }

        .btn-text {
            background-color: transparent;
            color: var(--primary);
        }

        .btn-text:hover {
            background-color: rgba(103, 80, 164, 0.08);
        }

        .btn-disabled {
            background-color: rgba(28, 27, 31, 0.12);
            color: rgba(28, 27, 31, 0.38);
            cursor: not-allowed;
            box-shadow: none;
        }

        .btn-disabled::after {
            display: none;
        }

        .btn-icon {
            margin-right: 8px;
            font-size: 18px;
        }

        /* 卡片样式 */
        .card-supporting-text {
            font-size: 0.875rem;
            color: var(--on-surface-variant);
            margin-bottom: 16px;
            line-height: 1.5;
            transition: var(--theme-transition);
        }

        /* 文件上传区域样式 */
        .file-upload-area {
            margin: 20px 0;
            padding: 20px;
            border: 2px dashed var(--outline);
            border-radius: var(--shape-corner-medium);
            background-color: var(--surface-variant);
            text-align: center;
            transition: all var(--motion-duration-short4) var(--motion-easing-emphasized);
            cursor: pointer;
        }

        .file-upload-area:hover {
            border-color: var(--primary);
            background-color: var(--primary-container);
        }

        .file-upload-area.drag-over {
            border-color: var(--primary);
            background-color: var(--primary-container);
            transform: scale(1.02);
        }

        .file-upload-icon {
            font-size: 48px;
            color: var(--primary);
            margin-bottom: 16px;
        }

        .file-upload-text {
            font-size: 1rem;
            color: var(--on-surface);
            margin-bottom: 8px;
        }

        .file-upload-hint {
            font-size: 0.875rem;
            color: var(--on-surface-variant);
        }

        /* 文件信息显示 */
        .file-info {
            margin-top: 16px;
            padding: 16px;
            background-color: var(--surface);
            border-radius: var(--shape-corner-medium);
            border: 1px solid var(--outline);
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .file-info.show {
            display: block;
        }

        .file-name {
            font-weight: 500;
            color: var(--on-surface);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .file-size {
            font-size: 0.875rem;
            color: var(--on-surface-variant);
        }

        .file-actions {
            display: flex;
            gap: 8px;
            margin-top: 12px;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* 进度条 */
        .progress-container {
            width: 100%;
            height: 4px;
            background-color: var(--surface-variant);
            border-radius: 2px;
            margin: 16px 0;
            overflow: hidden;
            display: none;
        }

        .progress-bar {
            height: 100%;
            width: 0%;
            background-color: var(--primary);
            border-radius: 2px;
            transition: width 0.3s ease;
        }

        /* 状态消息 */
        .status-message {
            margin-top: 10px;
            padding: 12px 16px;
            border-radius: var(--shape-corner-medium);
            background: var(--surface);
            display: none;
            transition: all 0.3s ease;
            box-shadow: var(--elevation-1);
            animation: fadeIn 0.3s ease;
        }

        .success {
            background-color: var(--tertiary-container);
            color: var(--on-tertiary-container);
            border-left: 4px solid var(--tertiary);
        }

        .error {
            background-color: var(--error-container);
            color: var(--on-error-container);
            border-left: 4px solid var(--error);
        }

        .warning {
            background-color: var(--secondary-container);
            color: var(--on-secondary-container);
            border-left: 4px solid var(--secondary);
        }

        /* 按钮容器 */
        .button-container {
            display: flex;
            gap: 12px;
            margin-top: 16px;
            flex-wrap: wrap;
        }

        /* 隐藏的文件输入 */
        .file-input-hidden {
            display: none;
        }

        /* 按钮网格样式 */
        .button-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 12px;
            margin-top: 16px;
        }

        /* 新增的样式类 */
        .btn-tonal {
            background-color: var(--secondary-container);
            color: var(--on-secondary-container);
            border: none;
        }

        .btn-tonal:hover {
            background-color: var(--secondary-container);
            filter: brightness(1.1);
        }

        .tutorial-section {
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--outline);
        }

        .tutorial-section:last-child {
            border-bottom: none;
        }

        .card {
            background-color: var(--surface);
            border-radius: var(--shape-corner-large);
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: var(--elevation-1);
        }

        .card-content {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .card-headline {
            font-size: 1.25rem;
            font-weight: 500;
            color: var(--on-surface);
        }

        .license-text {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid var(--outline);
            color: var(--on-surface-variant);
            font-size: 0.875rem;
        }

        /* 主题切换时的特殊动画 */
        @keyframes themeSwitch {
            0% {
                opacity: 0.8;
                transform: scale(0.95);
            }
            50% {
                opacity: 0.5;
                transform: scale(1.05);
            }
            100% {
                opacity: 1;
                transform: scale(1);
            }
        }

        .theme-switching {
            animation: themeSwitch 0.5s ease;
        }

        /* 响应式调整 */
        @media (max-width: 768px) {
            .button-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            }
            
            .theme-toggle-container {
                top: 10px;
                right: 10px;
            }
            
            .theme-toggle-btn {
                width: 44px;
                height: 44px;
            }
        }

        @media (max-width: 480px) {
            .button-grid {
                grid-template-columns: 1fr;
            }
            
            .section {
                padding: 16px;
            }
        }
    </style>
</head>
<body>
    <!-- 主题切换按钮 -->
    <div class="theme-toggle-container">
        <button class="theme-toggle-btn" id="themeToggleBtn">
            <i class="material-icons theme-icon" id="themeIcon">dark_mode</i>
        </button>
    </div>

    <div class="container">
        <div class="header">
            <h1>小米巨能写BL解锁工具</h1>
        </div>

        <!-- 调试模式选择 -->
        <div class="section">
            <h2>调试模式</h2>
            <div class="card-actions">
                <button class="btn btn-filled" onclick="selectFirmware('adb')">
                    <i class="material-icons btn-icon">wifi</i>
                    adb 无线调试
                </button>
                <button class="btn btn-filled" onclick="selectFirmware('usb')">
                    <i class="material-icons btn-icon">usb</i>
                    USB调试
                </button>
            </div>
        </div>

        <div class="file-upload-area" id="fileUploadArea">
            <div class="file-upload-icon">
                <i class="material-icons">cloud_upload</i>
            </div>
            <div class="file-upload-text">点击或拖拽文件到此处上传</div>
            <div class="file-upload-hint">支持 .zip 和 .ngzx 格式</div>
            <div class="file-upload-hint">最大文件大小: 100MB</div>
            
            <input type="file" id="firmwareUpload" class="file-input-hidden" accept=".zip,.ngzx">
            
            <div class="button-container">
                <button class="btn btn-outlined" onclick="document.getElementById('firmwareUpload').click()">
                    <i class="material-icons btn-icon">folder_open</i>
                    浏览文件
                </button>
                <button class="btn btn-text" onclick="clearSelectedFile()">
                    <i class="material-icons btn-icon">delete</i>
                    清除
                </button>
            </div>
        </div>

        <!-- 文件信息显示 -->
        <div id="fileInfo" class="file-info">
            <div class="file-name">
                <i class="material-icons" style="color: var(--primary);">description</i>
                <span id="fileName"></span>
            </div>
            <div class="file-size" id="fileSize"></div>
            
            <div class="progress-container" id="uploadProgress">
                <div class="progress-bar" id="progressBar"></div>
            </div>
            
            <div class="file-actions">
                <button class="btn btn-text" onclick="validateFile()">
                    <i class="material-icons btn-icon">check_circle</i>
                    验证文件
                </button>
                <button class="btn btn-filled" onclick="uploadFile()">
                    <i class="material-icons btn-icon">upload</i>
                    开始上传
                </button>
            </div>
        </div>

        <!-- 官方固件降级 -->
        <div class="section">
            <h2>官方固件降级</h2>
            <div class="button-grid">
                <button class="btn btn-tonal" onclick="selectFirmware('miui9')">MIUI 9</button>
                <button class="btn btn-tonal" onclick="selectFirmware('miui10')">MIUI 10</button>
                <button class="btn btn-tonal" onclick="selectFirmware('miui11')">MIUI 11</button>
                <button class="btn btn-tonal" onclick="selectFirmware('miui12')">MIUI 12</button>
                <button class="btn btn-tonal" onclick="selectFirmware('miui12.5')">MIUI 12.5</button>
                <button class="btn btn-tonal" onclick="selectFirmware('miui13')">MIUI 13</button>
                <button class="btn btn-tonal" onclick="selectFirmware('miui14')">MIUI 14</button>
                <button class="btn btn-tonal" onclick="selectFirmware('hyperos1')">澎湃OS 1.0</button>
                <button class="btn btn-tonal" onclick="selectFirmware('hyperos2')">澎湃OS 2.0</button>
                <button class="btn btn-tonal" onclick="selectFirmware('hyperos3')">澎湃OS 3.0</button>
            </div>
        </div>

        <!-- 第三方固件 -->
        <div class="section">
            <h2>第三方固件</h2>
            <div class="button-grid">
                <button class="btn btn-outlined" onclick="selectFirmware('chenguang')">晨光适配版</button>
                <button class="btn btn-outlined" onclick="selectFirmware('deli_s865')">得力S865适配版</button>
                <button class="btn btn-outlined" onclick="selectFirmware('sanlin_um100')">三菱um100</button>
                <button class="btn btn-outlined" onclick="selectFirmware('xmzxb')">小米中性笔</button>
                <button class="btn btn-outlined" onclick="selectFirmware('flyme12')">Flyme 12</button>
                <button class="btn btn-outlined" onclick="selectFirmware('fedoralinux39')">Fedora Linux 41</button>
                <button class="btn btn-outlined" onclick="selectFirmware('lineageos19')">LineageOS 19</button>
                <button class="btn btn-outlined" onclick="selectFirmware('pep13')">Pixel Experience Plus 13</button>
                <button class="btn btn-outlined" onclick="selectFirmware('archlinux')">Arch Linux</button>
                <button class="btn btn-outlined" onclick="selectFirmware('ubuntults')">Ubuntu 24.04.2 LTS</button>
                <button class="btn btn-outlined" onclick="selectFirmware('GrapheneOS')">石墨烯系统</button>
                <button class="btn btn-outlined" onclick="selectFirmware('hm')">红门6</button>
                <button class="btn btn-outlined" onclick="selectFirmware('freebsd')">FreeBSD</button>
                <button class="btn btn-outlined" onclick="selectFirmware('mint')">Linux Mint</button>
                <button class="btn btn-outlined" onclick="selectFirmware('oppenwrt')">OpenWrt</button>
                <button class="btn btn-outlined" onclick="selectFirmware('mac')">mac OS 13</button>
                <button class="btn btn-outlined" onclick="selectFirmware('zorin')">Zorin OS 17.3 Pro</button>
                <button class="btn btn-outlined" onclick="selectFirmware('fyde')">Fyde OS 20</button>
                <button class="btn btn-outlined" onclick="selectFirmware('oneui')">One UI</button>
                <button class="btn btn-outlined" onclick="selectFirmware('funtouch')">Funtouch OS 10</button>
                <button class="btn btn-outlined" onclick="selectFirmware('pixelos')">Pixel OS</button>
                <button class="btn btn-outlined" onclick="selectFirmware('win8')">Windows 8.1</button>
                <button class="btn btn-outlined" onclick="selectFirmware('win10')">Windows 10</button>
                <button class="btn btn-outlined" onclick="selectFirmware('win11')">Windows 11</button>
            </div>
        </div>

        <!-- 第三方包 -->
        <div class="section">
            <h2>第三方包（npck包管理器）</h2>
            <div class="button-grid">
                <button class="btn btn-text" onclick="selectFirmware('tghz')">10GHz超频包</button>
                <button class="btn btn-text" onclick="selectFirmware('gemini2500')">Gemini 2.5 Flash</button>
                <button class="btn btn-text" onclick="selectFirmware('ds')">Dicksuck 3.1</button>
                <button class="btn btn-text" onclick="selectFirmware('bitlink')">交火挖比特币</button>
                <button class="btn btn-text" onclick="selectFirmware('jdkpcl2')">JDK17 + PCL2</button>
                <button class="btn btn-text" onclick="selectFirmware('gcam')">谷歌相机75合一</button>
                <button class="btn btn-text" onclick="selectFirmware('micam')">小米15移植相机包</button>
                <button class="btn btn-text" onclick="selectFirmware('tpm2')">TPM 2.0激活</button>
            </div>
        </div>

        <!-- 解锁教程 -->
        <div class="section">
            <h2>解锁教程</h2>
            <div class="tutorial-section">
                <h3>步骤1: 进入Fastboot模式</h3>
                <p>关机后拔出底盖进入Fastboot模式...</p>
            </div>
            <div class="tutorial-section">
                <h3>步骤2: 连接解锁</h3>
                <p>使用解锁工具连接设备并解锁...</p>
            </div>
        </div>

        <!-- 使用提示卡片 -->
        <div class="card">
            <div class="card-content">
                <h3 class="card-headline">使用提示与技巧</h3>
                <p class="card-supporting-text">为了获得最佳的解锁体验，请遵循以下建议：</p>
                <ul class="card-supporting-text" style="padding-left: 20px;">
                    <li>确保设备电量充足（建议80%以上）</li>
                    <li>提前备份重要数据，解锁过程可能会清除数据</li>
                    <li>选择与设备型号匹配的固件版本</li>
                    <li>解锁后可以自由安装自定义固件</li>
                    <li>定期检查更新以获取最新功能</li>
                </ul>
                <p class="card-supporting-text">如有任何问题，请参考详细教程或联系技术支持。</p>
            </div>
        </div>

        <!-- 操作按钮 -->
        <div class="section">
            <h2>执行操作</h2>
            <div class="card-actions">
                <button class="btn btn-filled" id="installBtn" onclick="handleAction('sudomiinstall')">
                    <i class="material-icons btn-icon">install_desktop</i>
                    解锁并刷入固件/降级
                </button>
                <button class="btn btn-outlined" id="unlockBtn" onclick="handleAction('oubl')">
                    <i class="material-icons btn-icon">lock_open</i>
                    仅解锁
                </button>
                <button class="btn btn-outlined" id="recoveryBtn" onclick="handleAction('rec')">
                    <i class="material-icons btn-icon">restore</i>
                    恢复模式刷机
                </button>
            </div>

            <div id="progress-container" class="progress-container">
                <div id="progress-bar" class="progress-bar"></div>
            </div>

            <div id="statusMessage" class="status-message"></div>
        </div>

        <!-- 许可证信息 -->
        <div class="license-text">
            <p>此软件基于GPL v3开源,请按照开源协议使用</p>
            <p>vre 3.1</p>
        </div>
    </div>

<script>

        const firmwareNames = {
            'adb': 'mi pen Wireless debug',
            'usb': 'USB debug',
            'miui9': 'MIUI 9',
            'miui10': 'MIUI 10',
            'miui11': 'MIUI 11',
            'miui12': 'MIUI 12',
            'miui12.5': 'MIUI 12.5',
            'miui13': 'MIUI 13',
            'miui14': 'MIUI 14',
            'hyperos1': '澎湃OS 1.0',
            'hyperos2': '澎湃OS 2.0',
            'hyperos3': '澎湃OS 3.0',
            'chenguang': '晨光适配版',
            'deli_s865': '得力S865适配版',
            'sanlin_um100': '三菱um100',
            'ds': '点石移植固件',
            'flyme12': 'flyme12',
            'fedoralinux39': 'fedoralinux43',
            'lineageos19': 'lineageOS19(a13)',
            'pep13': 'pixel experience plus 13',
            'archlinux': 'archlinux',
            'ubuntults': 'ubuntu24.04.2 LTS破解版(去snap，去广告)',
            'GrapheneOS': '石墨烯系统',
            'hm': '花伪红门5',
            'freebsd': 'freebsd',
            'mint': 'linuxmint ',
            'oppenwrt': 'oppenwrt',
            'mac': 'mac OS 13 ',
            'xmzxb': '小米中性笔',
            'zorin': 'zorin OS 17.3 Pro',
            'fyde': 'fyde OS 20',
            'oneui': 'oneui',
            'funtouch': 'funtouch OS 10',
            'pixelos': 'pixel OS',
            'win8': 'windows 8.1',
            'win10': 'windows10',
            'win11': 'windows11',
            'tghz': '10ghz超频包by nnnn',
            'gemini2500': 'gemini 2.5flash(nnnn)',
            'bitlink': '交火挖比特币(号角工作室)',
            'jdkpcl2': 'jdk17+pcl2',
            'gcam': '谷歌相机75合一(nnnn)',
            'micam': '小米15移植相机包v6.0(log模式+水印)',
            'ds': 'dicksuck 3.1',
            'tpm2': 'tpm2.0激活(win11)',
            'sudomiinstall': '解锁并刷入固件/降级',
            'oubl': '仅解锁',
            'rec': '恢复模式刷机'
        };

        // 主题切换功能
        const themeToggleBtn = document.getElementById('themeToggleBtn');
        const themeIcon = document.getElementById('themeIcon');
        const body = document.body;
        
        // 检查本地存储中的主题偏好
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme === 'dark') {
            body.classList.add('dark-mode');
            themeIcon.textContent = 'light_mode';
        }
        
        // 主题切换事件
        themeToggleBtn.addEventListener('click', function() {
            // 添加切换动画
            body.classList.add('theme-switching');
            
            // 切换主题
            body.classList.toggle('dark-mode');
            
            // 更新图标
            if (body.classList.contains('dark-mode')) {
                themeIcon.textContent = 'light_mode';
                localStorage.setItem('theme', 'dark');
            } else {
                themeIcon.textContent = 'dark_mode';
                localStorage.setItem('theme', 'light');
            }
            
            // 移除动画类
            setTimeout(() => {
                body.classList.remove('theme-switching');
            }, 500);
            
            // 添加按钮点击效果
            this.style.transform = 'scale(0.9)';
            setTimeout(() => {
                this.style.transform = '';
            }, 150);
        });

        function selectFirmware(type) {
            if (!['sudomiinstall', 'oubl', 'rec'].includes(type)) {
                alert(`已选择包: ${firmwareNames[type]}`);
            }
        }

        document.getElementById('firmwareUpload').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;

            const fileName = file.name;
            const fileExt = fileName.split('.').pop().toLowerCase();

            if (fileExt !== 'zip' && fileExt !== 'ngzx') {
                showStatus('只支持.zip和.ngzx格式的固件文件', 'error');
                return;
            }

            document.getElementById('fileNameDisplay').textContent = fileName;
            showStatus(`已选择自定义固件: ${fileName}`, 'success');
        });

        function showStatus(message, type) {
            const statusElement = document.getElementById('statusMessage');
            statusElement.textContent = message;
            statusElement.className = 'status-message ' + (type || '');
            statusElement.style.display = 'block';

            setTimeout(() => {
                statusElement.style.display = 'none';
            }, 5000);
        }

        function handleAction(actionType) {
            // 禁用按钮
            document.getElementById('installBtn').disabled = true;
            document.getElementById('unlockBtn').disabled = true;
            document.getElementById('recoveryBtn').disabled = true;

            // 显示进度条
            const progressContainer = document.getElementById('progress-container');
            const progressBar = document.getElementById('progress-bar');

            progressContainer.style.display = 'block';
            progressBar.style.width = '0%';

            // 显示状态
            showStatus('开始执行，请勿关闭页面...', 'warning');

            // 模拟进度
            let progress = 0;
            const interval = setInterval(() => {
                progress += 5;
                progressBar.style.width = progress + '%';

                if (progress >= 100) {
                    clearInterval(interval);

                    // 完成
                    showStatus('执行完成！', 'success');

                    // 重新启用按钮
                    document.getElementById('installBtn').disabled = false;
                    document.getElementById('unlockBtn').disabled = false;
                    document.getElementById('recoveryBtn').disabled = false;

                    // 隐藏进度条
                    setTimeout(() => {
                        progressContainer.style.display = 'none';
                    }, 5000);
                }
            }, 150);

            selectFirmware(actionType);
        }

        // 文件上传相关功能
        let selectedFile = null;
        
        function clearSelectedFile() {
            document.getElementById('firmwareUpload').value = '';
            document.getElementById('fileInfo').classList.remove('show');
            selectedFile = null;
            showStatus('已清除选择的文件', 'warning');
        }
        
        function validateFile() {
            if (!selectedFile) {
                showStatus('请先选择文件', 'error');
                return;
            }
            
            showStatus('文件验证通过，格式正确', 'success');
        }
        
        function uploadFile() {
            if (!selectedFile) {
                showStatus('请先选择文件', 'error');
                return;
            }
            
            const progressContainer = document.getElementById('uploadProgress');
            const progressBar = document.getElementById('progressBar');
            
            progressContainer.style.display = 'block';
            progressBar.style.width = '0%';
            
            showStatus('开始上传文件...', 'warning');
            
            // 模拟上传进度
            let progress = 0;
            const interval = setInterval(() => {
                progress += 10;
                progressBar.style.width = progress + '%';
                
                if (progress >= 100) {
                    clearInterval(interval);
                    showStatus('文件上传成功！', 'success');
                    setTimeout(() => {
                        progressContainer.style.display = 'none';
                    }, 2000);
                }
            }, 200);
        }
        
        // 文件上传区域拖拽功能
        const fileUploadArea = document.getElementById('fileUploadArea');
        const fileInput = document.getElementById('firmwareUpload');
        const fileInfo = document.getElementById('fileInfo');
        const fileName = document.getElementById('fileName');
        const fileSize = document.getElementById('fileSize');
        
        // 点击上传区域触发文件选择
        fileUploadArea.addEventListener('click', () => {
            fileInput.click();
        });
        
        // 文件选择事件
        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                selectedFile = e.target.files[0];
                updateFileInfo(selectedFile);
            }
        });
        
        // 拖拽功能
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            fileUploadArea.addEventListener(eventName, preventDefaults, false);
        });
        
        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }
        
        ['dragenter', 'dragover'].forEach(eventName => {
            fileUploadArea.addEventListener(eventName, highlight, false);
        });
        
        ['dragleave', 'drop'].forEach(eventName => {
            fileUploadArea.addEventListener(eventName, unhighlight, false);
        });
        
        function highlight() {
            fileUploadArea.classList.add('drag-over');
        }
        
        function unhighlight() {
            fileUploadArea.classList.remove('drag-over');
        }
        
        // 处理文件放置
        fileUploadArea.addEventListener('drop', (e) => {
            const dt = e.dataTransfer;
            const files = dt.files;
            
            if (files.length > 0) {
                selectedFile = files[0];
                updateFileInfo(selectedFile);
                fileInput.files = files; // 同步到文件输入元素
            }
        });
        
        function updateFileInfo(file) {
            fileName.textContent = file.name;
            fileSize.textContent = `大小: ${formatFileSize(file.size)}`;
            fileInfo.classList.add('show');
            showStatus(`已选择文件: ${file.name}`, 'success');
        }
        
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        // 简单的交互逻辑
        document.addEventListener('DOMContentLoaded', function() {
            // 为所有按钮添加点击效果
            const buttons = document.querySelectorAll('.btn:not(.btn-disabled)');
            buttons.forEach(button => {
                button.addEventListener('click', function() {
                    this.style.transform = 'scale(0.98)';
                    setTimeout(() => {
                        this.style.transform = '';
                    }, 150);
                });
            });
            
            // 初始化文件上传区域
            updateFileInfo = updateFileInfo;
        });
    </script>
</body>
</html>
